<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="910" height="1084"><desc style="-webkit-tap-highlight-color:transparent">Created with RaphaÃ«l 2.2.0</desc><defs style="-webkit-tap-highlight-color:transparent"><path id="raphael-marker-block" stroke-linecap="round" d="M5,0 0,2.5 5,5z" style="-webkit-tap-highlight-color:transparent"/><marker id="raphael-marker-endblock55-objlhakr" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objgx20d" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objv3hdf" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-obj7vdux" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-objzic59" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker><marker id="raphael-marker-endblock55-obj1ws2h" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5" style="-webkit-tap-highlight-color:transparent"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block" style="-webkit-tap-highlight-color:transparent"/></marker></defs><rect width="78.016" height="38" x="212.648" y="20" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="58.016" height="18" x="222.844" y="30" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="251.656" y="39" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Client</tspan></text><rect width="78.016" height="38" x="212.648" y="1026.125" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="58.016" height="18" x="222.844" y="1036.125" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="251.656" y="1045.125" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Client</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M251.65625,58L251.65625,1026.125" style="-webkit-tap-highlight-color:transparent"/><rect width="78.016" height="38" x="550.711" y="20" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="58.016" height="18" x="560.906" y="30" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="589.719" y="39" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Server</tspan></text><rect width="78.016" height="38" x="550.711" y="1026.125" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="58.016" height="18" x="560.906" y="1036.125" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="589.719" y="1045.125" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Server</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M589.71875,58L589.71875,1026.125" style="-webkit-tap-highlight-color:transparent"/><rect width="154.031" height="18" x="343.875" y="74" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="420.688" y="83" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">CLIENT_PRECOMMIT</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objlhakr)" d="M251.65625,96C251.65625,96,542.7767859138548,96,584.7106521709775,96" style="-webkit-tap-highlight-color:transparent"/><rect width="202.438" height="47.219" x="609.719" y="116" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="192.438" height="37.219" x="614.922" y="121" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="710.938" y="139.609" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.602" style="-webkit-tap-highlight-color:transparent">Server validation of</tspan><tspan x="710.938" dy="19.2" style="-webkit-tap-highlight-color:transparent">CLIENT_PRECOMMIT</tspan></text><rect width="154.031" height="18" x="343.875" y="179.219" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="420.688" y="188.219" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">SERVER_PRECOMMIT</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objgx20d)" d="M589.71875,201.21875C589.71875,201.21875,298.59821408614516,201.21875,256.6643478290225,201.21875" style="-webkit-tap-highlight-color:transparent"/><rect width="202.438" height="47.219" x="29.219" y="221.219" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="192.438" height="37.219" x="34.422" y="226.219" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="130.438" y="244.828" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.602" style="-webkit-tap-highlight-color:transparent">Client validation of</tspan><tspan x="130.438" dy="19.2" style="-webkit-tap-highlight-color:transparent">SERVER_PRECOMMIT</tspan></text><rect width="211.656" height="66.406" x="20" y="288.438" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="201.656" height="56.406" x="25" y="293.438" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="125.828" y="321.641" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-13.203" style="-webkit-tap-highlight-color:transparent">Generate verifiable</tspan><tspan x="125.828" dy="19.2" style="-webkit-tap-highlight-color:transparent">client identity based</tspan><tspan x="125.828" dy="19.2" style="-webkit-tap-highlight-color:transparent">on previous messages</tspan></text><rect width="86.828" height="18" x="377.469" y="370.844" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="420.688" y="379.844" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">CLIENT_ID</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objv3hdf)" d="M251.65625,392.84375C251.65625,392.84375,542.7767859138548,392.84375,584.7106521709775,392.84375" style="-webkit-tap-highlight-color:transparent"/><rect width="202.438" height="47.219" x="609.719" y="412.844" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="192.438" height="37.219" x="614.922" y="417.844" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="710.938" y="436.453" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.602" style="-webkit-tap-highlight-color:transparent">Server validation of</tspan><tspan x="710.938" dy="19.2" style="-webkit-tap-highlight-color:transparent">CLIENT_ID</tspan></text><rect width="211.656" height="66.406" x="609.719" y="480.063" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="201.656" height="56.406" x="614.719" y="485.063" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="715.547" y="513.266" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-13.203" style="-webkit-tap-highlight-color:transparent">Generate verifiable</tspan><tspan x="715.547" dy="19.2" style="-webkit-tap-highlight-color:transparent">server identity based</tspan><tspan x="715.547" dy="19.2" style="-webkit-tap-highlight-color:transparent">on previous messages</tspan></text><rect width="86.828" height="18" x="377.469" y="562.469" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="420.688" y="571.469" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">SERVER_ID</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj7vdux)" d="M589.71875,584.46875C589.71875,584.46875,298.59821408614516,584.46875,256.6643478290225,584.46875" style="-webkit-tap-highlight-color:transparent"/><rect width="192.438" height="28" x="609.719" y="604.469" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="182.438" height="18" x="614.719" y="609.469" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="705.938" y="618.469" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Derive EKEP secrets</tspan></text><rect width="202.438" height="47.219" x="29.219" y="652.469" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="192.438" height="37.219" x="34.422" y="657.469" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="130.438" y="676.078" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.602" style="-webkit-tap-highlight-color:transparent">Client validation of</tspan><tspan x="130.438" dy="19.2" style="-webkit-tap-highlight-color:transparent">SERVER_ID</tspan></text><rect width="192.438" height="28" x="39.219" y="719.688" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="182.438" height="18" x="44.219" y="724.688" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="135.438" y="733.688" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Derive EKEP secrets</tspan></text><rect width="124.844" height="18" x="358.266" y="763.688" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="420.688" y="772.688" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">SERVER_FINISH</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-objzic59)" d="M589.71875,785.6875C589.71875,785.6875,298.59821408614516,785.6875,256.6643478290225,785.6875" style="-webkit-tap-highlight-color:transparent"/><rect width="202.438" height="47.219" x="29.219" y="805.688" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="192.438" height="37.219" x="34.422" y="810.688" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="130.438" y="829.297" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.602" style="-webkit-tap-highlight-color:transparent">Client validation of</tspan><tspan x="130.438" dy="19.2" style="-webkit-tap-highlight-color:transparent">SERVER_FINISH</tspan></text><rect width="124.844" height="18" x="358.266" y="868.906" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="420.688" y="877.906" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">CLIENT_FINISH</tspan></text><path fill="none" stroke="#000" stroke-dasharray="none" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj1ws2h)" d="M251.65625,890.90625C251.65625,890.90625,542.7767859138548,890.90625,584.7106521709775,890.90625" style="-webkit-tap-highlight-color:transparent"/><rect width="202.438" height="47.219" x="609.719" y="910.906" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="192.438" height="37.219" x="614.922" y="915.906" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="710.938" y="934.516" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="-3.602" style="-webkit-tap-highlight-color:transparent">Server validation of</tspan><tspan x="710.938" dy="19.2" style="-webkit-tap-highlight-color:transparent">CLIENT_FINISH</tspan></text><rect width="298.063" height="28" x="271.656" y="978.125" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><rect width="288.063" height="18" x="276.656" y="983.125" fill="none" stroke="none" rx="0" ry="0" style="-webkit-tap-highlight-color:transparent"/><text x="420.688" y="992.125" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="-webkit-tap-highlight-color:transparent;text-anchor:middle;font-family:&quot;Andale Mono&quot;,monospace;font-size:16px"><tspan dy="6" style="-webkit-tap-highlight-color:transparent">Derive record protocol secrets</tspan></text></svg>